# Story 1.1: Project-Scoped Foundation Setup

## Status
Approved

## Story
**As a** developer,  
**I want** complete project scaffolding with proper architecture and dependencies supporting project-scoped data isolation,  
**so that** I have a solid foundation for implementing the GMC Dashboard system with multiple independent project contexts.

## Acceptance Criteria
1. Python 3.12 project initialized with **uv** for modern Python project management and dependency handling
2. **npm** project initialized for JavaScript/React component management with multilanguage build integration
3. Directory structure created following microservices architecture: `/services/`, `/frontend/`, `/intelligence/`, `/infrastructure/`, `/shared/`, `/tests/`, `/config/`, `/database/`, `/monitoring/`, `/docs/`, `/.github/`
4. Service dependencies installed via uv: Flask for all microservices, openpyxl for calculation service, pandas/numpy for mathematical processing, database drivers (PostgreSQL, Neo4j, Weaviate, MongoDB, Redis), Kubernetes/Docker for orchestration
5. React development environment configured for advanced UI components with proper npm build integration
6. Development environment configured with proper logging, debugging, and hot-reload capabilities for both Python and JavaScript components
7. All microservices launch successfully with individual health-check endpoints, API Gateway routing configured, React frontend connects to services through API Gateway with proper authentication
8. Git repository initialized with proper .gitignore covering both Python (uv) and JavaScript (npm) artifacts and initial commit structure
9. Database schemas designed with project_id foreign key relationships across all services for complete project data isolation
10. Microservices configured to handle project-scoped operations with proper project context validation and data boundaries

## Tasks / Subtasks

- [ ] **Task 1: Initialize Modern Python Project Environment with uv** (AC: 1, 4)
  - [ ] Install and configure uv package manager
  - [ ] Create pyproject.toml with Python 3.12 requirement
  - [ ] Set up virtual environment with uv
  - [ ] Configure development dependencies and build tools

- [ ] **Task 2: Initialize npm Frontend Environment** (AC: 2, 5)
  - [ ] Create package.json with React 18+ and TypeScript 5.3+
  - [ ] Configure Vite build system for fast development
  - [ ] Install UI framework dependencies (Tailwind CSS, Headless UI)
  - [ ] Set up frontend build integration with Python services

- [ ] **Task 3: Create Complete Microservices Directory Structure** (AC: 3)
  - [ ] Create `/services/` directory with microservice subdirectories
  - [ ] Create `/frontend/` directory with React application structure  
  - [ ] Create `/intelligence/` directory following architecture specification
  - [ ] Create `/infrastructure/`, `/shared/`, `/tests/`, `/config/`, `/database/`, `/monitoring/` directories
  - [ ] Initialize `.github/workflows/` for CI/CD automation

- [ ] **Task 4: Install Core Service Dependencies** (AC: 4)
  - [ ] Install Flask 2.3+ for all microservices via uv
  - [ ] Install Excel integration: openpyxl 3.1+, xlwings 0.31+
  - [ ] Install mathematical processing: NumPy 1.26+, Pandas 2.1+
  - [ ] Install database drivers: PostgreSQL (psycopg2), Neo4j, MongoDB (pymongo), Redis
  - [ ] Install containerization: Docker SDK for Python

- [ ] **Task 5: Configure Multi-Database Architecture** (AC: 9)
  - [ ] Create PostgreSQL schemas for gmc-calculation-service with project_id FK relationships
  - [ ] Create PostgreSQL schemas for user-management-service with institutional boundaries  
  - [ ] Design MongoDB collections for content-management-service with project scoping
  - [ ] Configure Redis data structures for notification-service with project isolation
  - [ ] Create Neo4j schema constraints for knowledge-graph-service with project contexts

- [ ] **Task 6: Implement Core Microservices Skeleton** (AC: 7, 10)
  - [ ] Create gmc-calculation-service with Flask app, health endpoints, project validation
  - [ ] Create knowledge-graph-service with Neo4j integration and project scoping
  - [ ] Create user-management-service with PostgreSQL and authentication framework
  - [ ] Create content-management-service with MongoDB and document versioning
  - [ ] Create notification-service with Redis and real-time capabilities
  - [ ] Create analytics-service with PostgreSQL and ClickHouse integration

- [ ] **Task 7: Configure Development Environment** (AC: 6, 7)
  - [ ] Set up Docker Compose for local development with all databases
  - [ ] Configure hot-reload for Python services using Flask development mode
  - [ ] Configure hot-reload for React frontend using Vite HMR
  - [ ] Set up centralized logging with structured JSON format
  - [ ] Configure debugging support for both Python and JavaScript

- [ ] **Task 8: Implement API Gateway and Service Health Checks** (AC: 7)
  - [ ] Configure Kong API Gateway for service routing
  - [ ] Implement health check endpoints (`/health` and `/health/ready`) for all services
  - [ ] Set up service-to-service authentication
  - [ ] Configure API Gateway rate limiting and security policies
  - [ ] Test React frontend connectivity through API Gateway

- [ ] **Task 9: Initialize Git Repository with Proper Configuration** (AC: 8)
  - [ ] Create comprehensive .gitignore for Python (uv), JavaScript (npm), Docker, and IDE files
  - [ ] Initialize git repository with proper branching strategy
  - [ ] Create initial commit with project structure
  - [ ] Set up GitHub repository with branch protection rules

- [ ] **Task 10: Create Project Data Isolation Framework** (AC: 9, 10)
  - [ ] Implement project context middleware for all services
  - [ ] Create database constraints ensuring project_id foreign key relationships
  - [ ] Add project validation decorators for API endpoints
  - [ ] Implement cross-project data contamination prevention
  - [ ] Create project boundary validation test suite

## Dev Notes

### **Previous Story Insights**
No previous stories exist - this is the foundation story for the entire GMC Dashboard system.

### **Data Models** [Source: architecture/high-level-architecture.md#microservices-data-architecture]
- **PostgreSQL Tables**: `projects` (primary entity), `companies`, `gmc_reports`, `analysis_sessions`, `parameter_changes` - all with project_id foreign key relationships
- **MongoDB Collections**: Project-scoped document storage for content management and AI coaching data
- **Neo4j Schema**: GMC rule relationships with project context nodes and constraint validations
- **Redis Data Structures**: Project-isolated session management and real-time collaboration state
- **Project Entity Interface**: Core foundation with `project_id`, `data_isolation_boundary`, `timeline_independence` properties

### **API Specifications** [Source: architecture/high-level-architecture.md#api-gateway-configuration]
- **Service Ports**: gmc-calculation-service:5000, knowledge-graph-service:5001, ai-coaching-service:5002, user-management-service:5003
- **API Gateway**: Kong routing with JWT authentication, rate limiting (100/min calculations, 50/min knowledge, 20/min AI)
- **Health Endpoints**: All services implement `/health` and `/health/ready` for Kubernetes readiness/liveness probes
- **Authentication**: JWT tokens with project context validation and service-to-service communication

### **Component Specifications** [Source: architecture/components.md#backend-components]
- **GMC Calculation Engine**: Excel-equivalent processing with openpyxl primary, xlwings fallback, DAG-based calculation ordering
- **Knowledge Graph Service**: Neo4j integration for GMC rule relationships and constraint dependencies
- **AI Coaching Ecosystem**: Decomposed architecture with conversation-service, vector-search-service, ml-recommendation-service, coaching-orchestrator
- **Real-time Collaboration**: Flask-SocketIO with Redis coordination and project-scoped conflict resolution

### **File Locations** [Source: architecture/high-level-architecture.md#repository-structure]
- **Microservices**: `/services/{service-name}/app/` with main.py entry points, models/, routes/, services/ subdirectories
- **Frontend**: `/frontend/src/` with components/, pages/, services/, hooks/, utils/ organization
- **Intelligence Directory**: `/intelligence/` with api-configs/, classical-ml-models/, llm-prompts/, deployment-configs/
- **Infrastructure**: `/infrastructure/k8s/`, `/infrastructure/docker-compose/`, `/infrastructure/helm/`
- **Database**: `/database/migrations/` with postgresql/, neo4j/, mongodb/ subdirectories

### **Testing Requirements**
No specific testing strategy document found in architecture docs - implement basic Flask testing framework with pytest for services and React Testing Library for frontend components.

### **Technical Constraints** [Source: architecture/high-level-architecture.md#core-technologies]
- **Python Version**: 3.12+ required for modern async features and type safety
- **Package Manager**: uv for Python (fast dependency resolution), npm for JavaScript ecosystem
- **Database Versions**: PostgreSQL 15+, Neo4j 5.x, MongoDB 7.x, Redis 7.2+, ClickHouse 23.x+
- **Container Orchestration**: Kubernetes 1.28+ with Helm 3.12+ for production deployment
- **Security**: AES-256-GCM encryption for API keys, JWT authentication, TLS 1.3 for service communication

### **Project Structure Notes**
Current project has `/docs/` and `/overview/` directories but missing complete microservices structure. Story 1.1 will create the full architecture-aligned directory structure including `/services/`, `/frontend/`, `/intelligence/`, `/infrastructure/`, etc. This represents the transformation from documentation-only project to complete implementation foundation.

### Testing
**Test File Locations**: 
- `/tests/integration/` for cross-service integration tests
- `/tests/e2e/` for end-to-end user workflow tests  
- `/services/{service-name}/tests/` for individual service unit tests
- `/frontend/src/__tests__/` for React component tests

**Test Frameworks**:
- **Python**: pytest 7.4+ with Coverage.py for comprehensive service testing
- **Frontend**: Vitest + React Testing Library for component testing
- **E2E**: Playwright 1.40+ for cross-browser testing
- **API**: HTTPx + Postman Collections for API contract validation

**Testing Standards**:
- All services must have health check endpoint tests
- Database integration tests for project isolation validation
- API Gateway routing tests with authentication
- Real-time collaboration testing with WebSocket connections

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-29 | 1.0 | Initial story creation with complete architecture context | Scrum Master |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be populated during implementation*

### Debug Log References  
*To be populated during implementation*

### Completion Notes List
*To be populated during implementation*

### File List
*To be populated during implementation*

## QA Results
*This section will be populated by the QA Agent after story completion*